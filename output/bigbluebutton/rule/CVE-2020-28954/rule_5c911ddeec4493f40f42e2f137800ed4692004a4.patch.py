import sys
import re
import json

def main():
    if len(sys.argv) < 2:
        print("[]")
        return

    file_path = sys.argv[1]
    try:
        with open(file_path, 'r', encoding='utf-8') as file:
            content = file.read()
    except:
        print("[]")
        return

    pattern = r'params\.fullName\s*=\s*StringUtils\.strip\(params\.fullName\)\s*;'
    matches = []
    lines = content.split('\n')
    for line_num, line in enumerate(lines, start=1):
        if re.search(pattern, line):
            matches.append({
                "loc": str(line_num),
                "reason": "Missing sanitization of control characters in fullName parameter after strip operation."
            })

    print(json.dumps(matches))

if __name__ == '__main__':
    main()